import pandas as pd
import datetime
import numpy as np

## Games data loading in all csv's 
games0a = pd.read_csv('0a_games.csv')
games0b = pd.read_csv('0b_games.csv')
games0c = pd.read_csv('0c_games.csv')
games0d = pd.read_csv('0d_games.csv')
games0e = pd.read_csv('0e_games.csv')
games1a = pd.read_csv('1a_games.csv')
games1b = pd.read_csv('1b_games.csv')
games1c = pd.read_csv('1c_games.csv')
games1d = pd.read_csv('1d_games.csv')
games1e = pd.read_csv('1e_games.csv')
games2a = pd.read_csv('2a_games.csv')
games2b = pd.read_csv('2b_games.csv')
games2c = pd.read_csv('2c_games.csv')
games2d = pd.read_csv('2d_games.csv')
games2e = pd.read_csv('2e_games.csv')
games3a = pd.read_csv('3a_games.csv')
games3b = pd.read_csv('3b_games.csv')
games3c = pd.read_csv('3c_games.csv')
games3d = pd.read_csv('3d_games.csv')
games3e = pd.read_csv('3e_games.csv') 
games4a = pd.read_csv('4a_games.csv')
games4b = pd.read_csv('4b_games.csv')
games4c = pd.read_csv('4c_games.csv')
games4d = pd.read_csv('4d_games.csv')
games4e = pd.read_csv('4e_games.csv')
games5a = pd.read_csv('5a_games.csv')
games5b = pd.read_csv('5b_games.csv')
games5c = pd.read_csv('5c_games.csv')
games5d = pd.read_csv('5d_games.csv')
games5e = pd.read_csv('5e_games.csv')
games6a = pd.read_csv('6a_games.csv')
games6b = pd.read_csv('6b_games.csv')
games6c = pd.read_csv('6c_games.csv')
games6d = pd.read_csv('6d_games.csv')
games6e = pd.read_csv('6e_games.csv')
games7a = pd.read_csv('7a_games.csv')
games7b = pd.read_csv('7b_games.csv')
games7c = pd.read_csv('7c_games.csv')
games7d = pd.read_csv('7d_games.csv')
games7e = pd.read_csv('7e_games.csv')
games8a = pd.read_csv('8a_games.csv')
games8b = pd.read_csv('8b_games.csv')
games8c = pd.read_csv('8c_games.csv')
games8d = pd.read_csv('8d_games.csv')
games8e = pd.read_csv('8e_games.csv')
games9a = pd.read_csv('9a_games.csv')
games9b = pd.read_csv('9b_games.csv')
games9c = pd.read_csv('9c_games.csv')
games9d = pd.read_csv('9d_games.csv')
games9e = pd.read_csv('9e_games.csv')
games10a = pd.read_csv('10a_games.csv')
games10b = pd.read_csv('10b_games.csv')
games10c = pd.read_csv('10c_games.csv')
games10d = pd.read_csv('10d_games.csv')
games10e = pd.read_csv('10e_games.csv')
games11a = pd.read_csv('11a_games.csv')
games11b = pd.read_csv('11b_games.csv')
games11c = pd.read_csv('11c_games.csv')
games11d = pd.read_csv('11d_games.csv')
games11e = pd.read_csv('11e_games.csv')
games12a = pd.read_csv('12a_games.csv')
games12b = pd.read_csv('12b_games.csv')
games12c = pd.read_csv('12c_games.csv')
games12d = pd.read_csv('12d_games.csv')
games12e = pd.read_csv('12e_games.csv')
games13a = pd.read_csv('13a_games.csv')
games13b = pd.read_csv('13b_games.csv')
games13c = pd.read_csv('13c_games.csv')
games13d = pd.read_csv('13d_games.csv')
games13e = pd.read_csv('13e_games.csv')
games14a = pd.read_csv('14a_games.csv')
games14b = pd.read_csv('14b_games.csv')
games14c = pd.read_csv('14c_games.csv')
games14d = pd.read_csv('14d_games.csv')
games14e = pd.read_csv('14e_games.csv')
games15a = pd.read_csv('15a_games.csv')
games15b = pd.read_csv('15b_games.csv')
games15c = pd.read_csv('15c_games.csv')
games15d = pd.read_csv('15d_games.csv')
games15e = pd.read_csv('15e_games.csv')
games16a = pd.read_csv('16a_games.csv')
games16b = pd.read_csv('16b_games.csv')

# Get all the games data in 1 df here!
games_final = pd.concat([games0a,games0b,games0c,games0d,games0e,games1a,games1b,games1c,games1d,games1e,games2a,games2b,games2c,games2d,games2e,
                         games3a,games3b,games3c,games3d,games3e,games4a,games4b,games4c,games4d,games4e,games5a,games5b,games5c,games5d,games5e,
                         games6a,games6b,games6c,games6d,games6e,games7a,games7b,games7c,games7d,games7e,games8a,games8b,games8c,games8d,games8e,
                         games9a,games9b,games9c,games9d,games9e,games10a,games10b,games10c,games10d,games10e,games11a,games11b,games11c,games11d,games11e,
                         games12a,games12b,games12c,games12d,games12e,games13a,games13b,games13c,games13d,games13e,games14a,games14b,games14c,games14d,games14e,
                         games15a,games15b,games15c,games15d,games15e,games16a,games16b])
games_final.to_csv('gamesfinaldata.csv')

## Updates data loading in all csv's
updates0a = pd.read_csv('0a_updatesdata.csv')
updates0bcde = pd.read_csv('0bcde_updatesdata.csv')
updates1a = pd.read_csv('1a_updatesdata.csv')
updates1bcde = pd.read_csv('1bcde_updatesdata.csv')
updates2a = pd.read_csv('2a_updatesdata.csv')
updates2bcde = pd.read_csv('2bcde_updatesdata.csv')
updates3a = pd.read_csv('3a_updatesdata.csv')
updates3bcde = pd.read_csv('3bcde_updatesdata.csv')
updates4a = pd.read_csv('4a_updatesdata.csv')
updates4bcde = pd.read_csv('4bcde_updatesdata.csv')
updates5a = pd.read_csv('5a_updatesdata.csv')
updates5bcde = pd.read_csv('5bcde_updatesdata.csv')
updates6a = pd.read_csv('6a_updatesdata.csv')
updates6bcde = pd.read_csv('6bcde_updatesdata.csv')
updates7a = pd.read_csv('7a_updatesdata.csv')
updates7bcde = pd.read_csv('7bcde_updatesdata.csv')
updates8a = pd.read_csv('8a_updatesdata.csv')
updates8bcde = pd.read_csv('8bcde_updatesdata.csv')
updates9a = pd.read_csv('9a_updatesdata.csv')
updates9bcde = pd.read_csv('9bcde_updatesdata.csv')
updates10abcde = pd.read_csv('10abcde_updatesdata.csv')
updates11abcde = pd.read_csv('11abcde_updatesdata.csv')
updates12abcde = pd.read_csv('12abcde_updatesdata.csv')
updates13abcde = pd.read_csv('13abcde_updatesdata.csv')
updates14abcde = pd.read_csv('14abcde_updatesdata.csv')
updates15abcde = pd.read_csv('15abcde_updatesdata.csv')
updates16ab = pd.read_csv('16ab_updatesdata.csv')

# Get all the updates data in 1 df here!
updates_final = pd.concat([updates0a, updates0bcde, updates1a, updates1bcde, updates2a, updates2bcde, updates3a, updates3bcde,
                           updates4a, updates4bcde, updates5a, updates5bcde, updates6a, updates6bcde, updates7a, updates7bcde,
                           updates8a, updates8bcde, updates9a, updates9bcde, updates10abcde, updates11abcde, updates12abcde,
                           updates13abcde, updates14abcde, updates15abcde, updates16ab])

#Remove unnecessary text for title in updatesdata
updates_final['updates_final'] = updates_final['title'].str.replace('Nieuwshub voor ', '')
del updates_final['title']
updates_final.columns = ['updates', 'title']
updates_final['updates_final'] = updates_final['title'].str.replace(' - Steam News Hub', '')
del updates_final['title']
updates_final.columns = ['updates', 'title']

#merge games and updates based on title 
finaldata = pd.merge(games_final, updates_final, on ='title')

#Remove any duplicated rows based on title
finaldata_1 = finaldata.drop_duplicates()

# SteamSpy 
#data read in per genre (11) and add genre as an extra column 
spy_act = pd.read_csv('actionsteamspy.csv')
spy_act['genre']= 'action'
spy_act['early_access']= 'no'
spy_adv = pd.read_csv('Adventuresteamspy.csv')
spy_adv['genre']= 'adventure'
spy_adv['early_access']= 'no'
spy_ear = pd.read_csv('earlyaccesssteamspy.csv')
spy_ear['genre']= 'early_access'
spy_ear['early_access']= 'yes'
spy_exe = pd.read_csv('exearlyaccesssteamspy.csv')
spy_exe['genre']= 'ex_early'
spy_exe['early_access']= 'yes'
spy_fre = pd.read_csv('freesteamspy.csv')
spy_fre['genre']= 'free'
spy_fre['early_access']= 'no'
spy_ind = pd.read_csv('Indiesteamspy.csv')
spy_ind['genre']= 'indie'
spy_ind['early_access']= 'no'
spy_mmo = pd.read_csv('masivelysteamspy.csv')
spy_mmo['genre']= 'mmo'
spy_mmo['early_access']= 'no'
spy_rpg = pd.read_csv('RPGsteamspy.csv')
spy_rpg['genre']= 'rpg'
spy_rpg['early_access']= 'no'
spy_sim = pd.read_csv('Simulationsteamspy.csv')
spy_sim['genre']= 'simulation'
spy_sim['early_access']= 'no'
spy_spo = pd.read_csv('Sportssteamspy.csv')
spy_spo['genre']= 'sports'
spy_spo['early_access']= 'no'
spy_str = pd.read_csv('strategysteamspy.csv')
spy_str['genre']= 'strategy'
spy_str['early_access']= 'no'

#Data merged into 1 dataset for steamspy data
data_steamspy_final = pd.concat([spy_act, spy_adv, spy_ear, spy_exe, spy_fre, spy_ind, spy_mmo, spy_rpg, spy_sim, spy_spo, spy_str])
data_steamspy_final.to_csv('spydatafinal.csv')

#Merge final_data and steamspy data into 1 last dataframe 
df = pd.merge(finaldata_1, data_steamspy_final, on = 'title')
#drop columns that are duplicates of eachother 
df = df.drop(df.columns[[1,2,3,4,7,8,11,12,14,15]], axis=1)

df2 = df['genre_y'].groupby([df.title]).apply(list).reset_index()
df3 = pd.merge(df,df2, on = 'title')
df4 = df3.drop_duplicates(subset='title', keep = 'first')
df4['number_alltime_reviews'] = df4['number_alltime_reviews'].str.replace(' reviews', '')
df4['number_alltime_reviews'] = df4['number_alltime_reviews'].str.strip("(")
df4['number_alltime_reviews'] = df4['number_alltime_reviews'].str.strip(")")
df4['number_recent_reviews'] = df4['number_recent_reviews'].str.replace(' reviews', '')
df4['number_recent_reviews'] = df4['number_recent_reviews'].str.strip("(")
df4['number_recent_reviews'] = df4['number_recent_reviews'].str.strip(")")
df4['number_alltime_reviews'] = df4['number_alltime_reviews'].str.replace(",", '')
df4['number_recent_reviews'] = df4['number_recent_reviews'].str.replace(",", '')
df5 = df4.drop(df4.columns[[7]], axis=1)
df6 = df5.rename({'genre_y_x': 'firstgenre','genre_y_y' : 'allgenres'}, axis =1)
df6['releasedate']= df6['releasedate'].str.replace('1,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('2,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('3,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('4,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('5,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('6,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('7,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('8,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('9,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('10,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('11,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('12,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('13,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('14,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('15,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('16,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('17,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('18,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('19,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('20,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('21,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('22,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('23,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('24,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('25,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('26,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('27,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('28,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('29,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('30,', ' ')
df6['releasedate']= df6['releasedate'].str.replace('31,', ' ')
df6['releasedate']= df6['releasedate'].str.replace(' 1 ', ' ')
df6['releasedate']= df6['releasedate'].str.replace(' 2 ', ' ')
df6['releasedate']= df6['releasedate'].str.replace(' 3 ', ' ')

df6['releasedate']= df6['releasedate'].str.replace('  ', '')
df6['releasedate']= df6['releasedate'].str.replace(' ', '')

df6['releasedate']= df6['releasedate'].str.replace('Dec2021', '2021-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2021', '2021-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2021', '2021-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2021', '2021-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2021', '2021-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2021', '2021-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2021', '2021-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2021', '2021-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2021', '2021-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2021', '2021-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2021', '2021-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2021', '2021-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2020', '2020-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2020', '2020-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2020', '2020-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2020', '2020-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2020', '2020-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2020', '2020-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2020', '2020-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2020', '2020-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2020', '2020-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2020', '2020-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2020', '2020-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2020', '2020-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2019', '2019-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2019', '2019-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2019', '2019-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2019', '2019-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2019', '2019-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2019', '2019-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2019', '2019-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2019', '2019-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2019', '2019-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2019', '2019-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2019', '2019-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2019', '2019-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2018', '2018-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2018', '2018-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2018', '2018-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2018', '2018-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2018', '2018-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2018', '2018-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2018', '2018-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2018', '2018-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2018', '2018-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2018', '2018-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2018', '2018-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2018', '2018-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2017', '2017-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2017', '2017-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2017', '2017-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2017', '2017-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2017', '2017-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2017', '2017-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2017', '2017-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2017', '2017-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2017', '2017-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2017', '2017-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2017', '2017-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2017', '2017-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2016', '2016-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2016', '2016-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2016', '2016-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2016', '2016-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2016', '2016-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2016', '2016-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2016', '2016-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2016', '2016-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2016', '2016-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2016', '2016-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2016', '2016-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2016', '2016-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2015', '2015-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2015', '2015-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2015', '2015-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2015', '2015-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2015', '2015-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2015', '2015-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2015', '2015-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2015', '2015-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2015', '2015-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2015', '2015-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2015', '2015-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2015', '2015-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2014', '2014-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2014', '2014-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2014', '2014-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2014', '2014-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2014', '2014-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2014', '2014-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2014', '2014-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2014', '2014-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2014', '2014-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2014', '2014-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2014', '2014-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2014', '2014-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2013', '2013-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2013', '2013-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2013', '2013-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2013', '2013-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2013', '2013-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2013', '2013-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2013', '2013-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2013', '2013-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2013', '2013-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2013', '2013-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2013', '2013-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2013', '2013-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2012', '2012-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2012', '2012-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2012', '2012-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2012', '2012-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2012', '2012-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2012', '2012-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2012', '2012-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2012', '2012-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2012', '2012-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2012', '2012-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2012', '2012-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2012', '2012-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2011', '2011-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2011', '2011-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2011', '2011-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2011', '2011-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2011', '2011-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2011', '2011-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2011', '2011-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2011', '2011-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2011', '2011-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2011', '2011-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2011', '2011-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2011', '2011-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2010', '2010-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2010', '2010-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2010', '2010-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2010', '2010-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2010', '2010-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2010', '2010-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2010', '2010-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2010', '2010-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2010', '2010-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2010', '2010-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2010', '2010-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2010', '2010-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2009', '2009-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2009', '2009-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2009', '2009-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2009', '2009-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2009', '2009-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2009', '2009-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2009', '2009-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2009', '2009-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2009', '2009-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2009', '2009-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2009', '2009-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2009', '2009-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2008', '2008-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2008', '2008-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2008', '2008-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2008', '2008-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2008', '2008-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2008', '2008-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2008', '2008-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2008', '2008-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2008', '2008-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2008', '2008-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2008', '2008-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2008', '2008-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2007', '2007-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2007', '2007-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2007', '2007-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2007', '2007-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2007', '2007-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2007', '2007-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2007', '2007-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2007', '2007-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2007', '2007-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2007', '2007-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2007', '2007-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2007', '2007-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2006', '2006-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2006', '2006-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2006', '2006-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2006', '2006-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2006', '2006-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2006', '2006-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2006', '2006-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2006', '2006-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2006', '2006-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2006', '2006-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2006', '2006-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2006', '2006-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2005', '2005-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2005', '2005-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2005', '2005-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2005', '2005-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2005', '2005-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2005', '2005-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2005', '2005-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2005', '2005-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2005', '2005-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2005', '2005-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2005', '2005-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2005', '2005-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2004', '2004-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2004', '2004-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2004', '2004-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2004', '2004-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2004', '2004-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2004', '2004-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2004', '2004-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2004', '2004-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2004', '2004-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2004', '2004-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2004', '2004-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2004', '2004-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2003', '2003-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2003', '2003-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2003', '2003-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2003', '2003-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2003', '2003-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2003', '2003-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2003', '2003-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2003', '2003-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2003', '2003-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2003', '2003-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2003', '2003-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2003', '2003-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2002', '2002-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2002', '2002-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2002', '2002-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2002', '2002-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2002', '2002-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2002', '2002-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2002', '2002-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2002', '2002-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2002', '2002-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2002', '2002-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2002', '2002-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2002', '2002-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2001', '2001-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2001', '2001-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2001', '2001-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2001', '2001-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2001', '2001-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2001', '2001-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2001', '2001-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2001', '2001-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2001', '2001-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2001', '2001-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2001', '2001-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2001', '2001-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec2000', '2000-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov2000', '2000-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct2000', '2000-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep2000', '2000-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug2000', '2000-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2000', '2000-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2000', '2000-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May2000', '2000-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2000', '2000-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar2000', '2000-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2000', '2000-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan2000', '2000-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec1999', '1999-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov1999', '1999-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct1999', '1999-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep1999', '1999-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun1999', '1999-06-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr1999', '1999-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar1999', '1999-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb1999', '1999-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1999', '1999-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec1998', '1998-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov1998', '1998-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct1998', '1998-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep1998', '1998-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug1998', '1998-08-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul1998', '1998-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun1998', '1998-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May1998', '1998-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr1998', '1998-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar1998', '1998-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec1997', '1997-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov1997', '1997-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct1997', '1997-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep1997', '1997-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul1997', '1997-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun1997', '1997-06-01')
df6['releasedate']= df6['releasedate'].str.replace('May1997', '1997-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr1997', '1997-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar1997', '1997-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1997', '1997-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec1996', '1996-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov1996', '1996-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct1996', '1996-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep1996', '1996-09-01')
df6['releasedate']= df6['releasedate'].str.replace('May1996', '1996-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr1996', '1996-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar1996', '1996-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec1995', '1995-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov1995', '1995-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct1995', '1995-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep1995', '1995-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr1995', '1995-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar1995', '1995-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb1995', '1995-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1995', '1995-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct1994', '1994-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep1994', '1994-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun1994', '1994-06-01')
df6['releasedate']= df6['releasedate'].str.replace('Mar1994', '1994-03-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb1994', '1994-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1994', '1994-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec1993', '1993-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Aug1993', '1993-08-01')
df6['releasedate']= df6['releasedate'].str.replace('May1993', '1993-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1993', '1993-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1992', '1992-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct1991', '1991-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun1991', '1991-06-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb1991', '1991-02-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1991', '1991-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec1990', '1990-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct1990', '1999-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun1990', '1990-06-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr1990', '1990-04-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1990', '1990-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Sep1989', '1989-09-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul1989', '1989-07-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun1989', '1989-06-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1989', '1989-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec1988', '1988-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1988', '1988-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Oct1987', '1987-10-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1987', '1987-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Dec1986', '1986-12-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul1986', '1986-07-01')
df6['releasedate']= df6['releasedate'].str.replace('May1986', '1986-05-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1986', '1986-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun1985', '1985-06-01')
df6['releasedate']= df6['releasedate'].str.replace('Jan1985', '1985-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Nov1984', '1984-11-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun1983', '1983-06-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul1970', '1970-07-01')


df6['releasedate']= df6['releasedate'].str.replace('TBD', '2022-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Jun2022', '2022-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Feb2022', '2022-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Comingsoon', '2022-01-01')
df6['releasedate']= df6['releasedate'].str.replace('ComingSoon', '2022-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Apr2024', '2022-01-01')
df6['releasedate']= df6['releasedate'].str.replace('tba-AddtoyourWishlist!', '2022-01-01')
df6['releasedate']= df6['releasedate'].str.replace('Jul2022', '2022-01-01')

# Remove rows that have not been correctly scraped, so the data is not in the right column and/or missing

df6.drop(df6.index[df6['releasedate'] == '$14.99'], inplace=True)
df6.drop(df6.index[df6['releasedate'] == '$19.99'], inplace=True)
df6.drop(df6.index[df6['releasedate'] == '$29.99'], inplace=True)
df6.drop(df6.index[df6['releasedate'] == '$5.99'], inplace=True)
df6.drop(df6.index[df6['releasedate'] == '$7.99'], inplace=True)
df6.drop(df6.index[df6['releasedate'] == '$9.89'], inplace=True)
df6.drop(df6.index[df6['releasedate'] == '$9.99'], inplace=True)


#Remove games below september 2003, because that was the month Steam started their company and remove games that still have to come out
df6= df6[~(df6['releasedate'] < '2013-09-01')]
df6= df6[~(df6['releasedate'] == '2022-01-01')]
# create new columns with current date, for amount of months since release date and update_count/months
df6['current_month'] = '2021-11-01'
df6['releasedate'] = pd.to_datetime(df6['releasedate'], errors='coerce')
df6['current_month'] = pd.to_datetime(df6['current_month'], errors='coerce')
df6['amount_months'] = df6['current_month'].dt.to_period('M').astype(int) - df6['releasedate'].dt.to_period('M').astype(int)
df6['updates_monthly'] = df6['updates']/df6['amount_months'] 



df6.drop(df6.index[df6['recent_review_summary'] == '1 user reviews'], inplace=True)
df6.drop(df6.index[df6['recent_review_summary'] == '2 user reviews'], inplace=True)
df6.drop(df6.index[df6['recent_review_summary'] == '3 user reviews'], inplace=True)
df6.drop(df6.index[df6['recent_review_summary'] == '4 user reviews'], inplace=True)
df6.drop(df6.index[df6['recent_review_summary'] == '5 user reviews'], inplace=True)
df6.drop(df6.index[df6['recent_review_summary'] == '6 user reviews'], inplace=True)
df6.drop(df6.index[df6['recent_review_summary'] == '7 user reviews'], inplace=True)
df6.drop(df6.index[df6['recent_review_summary'] == '8 user reviews'], inplace=True)
df6.drop(df6.index[df6['recent_review_summary'] == '9 user reviews'], inplace=True)

df6['price']= df6['price'].str.replace('$', '')
df6['price']= df6['price'].str.replace('Free', '0')
df6['price']= df6['price'].str.replace('0.00','0')
df6['price'] = df6['price'].astype(float)
df6['title'] = df6['title'].astype(str)
df6['alltime_reviews_summary'].fillna(df6['recent_review_summary'], inplace = True)
df6['allgenres'] = df6['allgenres'].astype(str)
df6['allgenres'] = df6['allgenres'].str.replace('[', '')
df6['allgenres'] = df6['allgenres'].str.replace("'", '')
df6['allgenres'] = df6['allgenres'].str.replace(']', '')
df6['firstgenre'] = np.where(df6['firstgenre'] == 'early_access', df6['allgenres'], df6['firstgenre'])
df6['firstgenre'] = np.where(df6['firstgenre'] == 'ex_early', df6['allgenres'], df6['firstgenre'])
df6['firstgenre'] = df6['firstgenre'].str.replace('early_access, ', '')
df6['firstgenre'] = df6['firstgenre'].str.replace('ex_early, ', '')
df6['firstgenre']= df6['firstgenre'].str.replace(', strategy', '')
df6['firstgenre']= df6['firstgenre'].str.replace(', sports', '')
df6['firstgenre']= df6['firstgenre'].str.replace(', simulation', '')
df6['firstgenre']= df6['firstgenre'].str.replace(', mmo', '')
df6['firstgenre']= df6['firstgenre'].str.replace(', adventure', '')
df6['firstgenre']= df6['firstgenre'].str.replace(', action', '')
df6['firstgenre']= df6['firstgenre'].str.replace(', indie', '')
df6['firstgenre']= df6['firstgenre'].str.replace(', rpg', '')
df6['firstgenre']= df6['firstgenre'].str.replace(', free', '')

df6['allgenres'] = df6['allgenres'].str.replace('strategy, ', '')
df6['allgenres'] = df6['allgenres'].str.replace('strategy ', '')
df6['allgenres'] = df6['allgenres'].str.replace('sports, ', '')
df6['allgenres'] = df6['allgenres'].str.replace('sports ', '')
df6['allgenres'] = df6['allgenres'].str.replace('simulation, ', '')
df6['allgenres'] = df6['allgenres'].str.replace('simulation ', '')
df6['allgenres'] = df6['allgenres'].str.replace('mmo, ', '')
df6['allgenres'] = df6['allgenres'].str.replace('mmo ', '')
df6['allgenres'] = df6['allgenres'].str.replace('adventure, ', '')
df6['allgenres'] = df6['allgenres'].str.replace('adventure ', '')
df6['allgenres'] = df6['allgenres'].str.replace('action, ', '')
df6['allgenres'] = df6['allgenres'].str.replace('action ', '')
df6['allgenres'] = df6['allgenres'].str.replace('indie, ', '')
df6['allgenres'] = df6['allgenres'].str.replace('indie ', '')
df6['allgenres'] = df6['allgenres'].str.replace('rpg, ', '')
df6['allgenres'] = df6['allgenres'].str.replace('rpg ', '')
df6['allgenres'] = df6['allgenres'].str.replace('free, ', '')
df6['allgenres'] = df6['allgenres'].str.replace('free ', '')
df6['allgenres'] = df6['allgenres'].str.replace(', strategy', '')
df6['allgenres'] = df6['allgenres'].str.replace(', sports', '')
df6['allgenres'] = df6['allgenres'].str.replace(', simulation', '')
df6['allgenres'] = df6['allgenres'].str.replace(', mmo', '')
df6['allgenres'] = df6['allgenres'].str.replace(', adventure', '')
df6['allgenres'] = df6['allgenres'].str.replace(', action', '')
df6['allgenres'] = df6['allgenres'].str.replace(', indie', '')
df6['allgenres'] = df6['allgenres'].str.replace(', rpg', '')
df6['allgenres'] = df6['allgenres'].str.replace(', free', '')
df6['allgenres'] = df6['allgenres'].str.replace('_access', '')
df6['allgenres'] = df6['allgenres'].str.replace('_access,', '')
df6['allgenres'] = df6['allgenres'].str.replace('ex_', '')
df6['allgenres'] = df6['allgenres'].str.replace(',ex_', '')
df6['allgenres'] = df6['allgenres'].str.replace(', early', '')

df6['early_access'] = np.where(df6['allgenres'] == 'early', 'yes', 'no')
df6['owners'] = df6['owners'].str.replace(' .. ', '-')


# After replacing the genre early access with the second genre for early access games, remove the firstgenre
df6.drop(df6.index[df6['firstgenre'] == 'early_access'], inplace=True)
df6.drop(df6.index[df6['firstgenre'] == 'ex_early'], inplace=True)
df7 = df6.dropna(subset = ['alltime_reviews_summary'])
df8 = df7.dropna(subset = [ 'price'])
df8.to_csv('steamandspydatafinal.csv', index=False)

# set ordinal categories for reviews
reviews_categories = ['Overwhelmingly Negative', 'Very Negative', 'Negative', 'Mostly Negative', 'Mixed', 'Mostly Positive', 'Positive', 'Very Positive', 'Overwhelmingly Positive']
df8['alltime_reviews_summary'] = pd.Categorical(df8['alltime_reviews_summary'], categories = reviews_categories)
df8.sort_values(by = "alltime_reviews_summary")

# Descriptive statistics and final save for using it for linear regresson in R (this is python)
des1 = df8['early_access'].value_counts()
des2 = df8['firstgenre'].value_counts()
des3 = df8.groupby(['early_access'])['updates_monthly'].mean()
des4 = df8.groupby(['firstgenre'])['early_access'].value_counts()
des5 = df8.groupby(['alltime_reviews_summary'])['early_access'].value_counts()
des6 = df8.groupby(['early_access'])['price'].mean()
des7 = df8.groupby(['early_access'])['number_alltime_reviews'].mean()
des8 = df8['alltime_reviews_summary'].value_counts()
df8.to_csv('analysisdata.csv', index=False)

